(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{246:function(e,t,a){e.exports=a.p+"assets/img/testdisk00.235b789b.png"},247:function(e,t,a){e.exports=a.p+"assets/img/testdisk01.32fe2ceb.png"},248:function(e,t,a){e.exports=a.p+"assets/img/testdisk02.93290af7.png"},249:function(e,t,a){e.exports=a.p+"assets/img/testdisk03.fa9bff85.png"},250:function(e,t,a){e.exports=a.p+"assets/img/testdisk04.a6e0ec1c.png"},251:function(e,t,a){e.exports=a.p+"assets/img/testdisk05.c9677934.png"},252:function(e,t,a){e.exports=a.p+"assets/img/testdisk06.7e47707a.png"},253:function(e,t,a){e.exports=a.p+"assets/img/testdisk07.32ed03c8.png"},254:function(e,t,a){e.exports=a.p+"assets/img/testdisk08.bf1cfb51.png"},255:function(e,t,a){e.exports=a.p+"assets/img/testdisk09.12f44c4b.png"},256:function(e,t,a){e.exports=a.p+"assets/img/testdisk10.1b5ebfe4.png"},257:function(e,t,a){e.exports=a.p+"assets/img/testdisk11.f45668d9.png"},258:function(e,t,a){e.exports=a.p+"assets/img/testdisk12.6f923c0e.png"},290:function(e,t,a){"use strict";a.r(t);var s=a(28),r=Object(s.a)({},(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h1",{attrs:{id:"linux-recovery-file-from-android-device-or-sd-card"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#linux-recovery-file-from-android-device-or-sd-card"}},[e._v("#")]),e._v(" Linux recovery file from android device or sd card üíª üì±")]),e._v(" "),s("p",[e._v("This is a quick overview from")]),e._v(" "),s("blockquote",[s("p",[s("a",{attrs:{href:"https://roubert.name/joakim/androidfilerecovery/",target:"_blank",rel:"noopener noreferrer"}},[e._v("roubert android file recovery main source"),s("OutboundLink")],1)])]),e._v(" "),s("p",[e._v("last one is useful for "),s("strong",[e._v("android internal memory")]),e._v(" here i'll highlight also for "),s("strong",[e._v("sd card memory")]),e._v(" recovery ü§ò")]),e._v(" "),s("h3",{attrs:{id:"prerequirement"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#prerequirement"}},[e._v("#")]),e._v(" Prerequirement")]),e._v(" "),s("ul",[s("li",[s("p",[e._v("The phone needs to be rooted. That sucks (yes, I prefer to keep my things stock if possible!), but if the files are important enough the hassle is worth it. If your phone was already rooted, you are good to go.")])]),e._v(" "),s("li",[s("p",[e._v("https://kingroot.net/")])]),e._v(" "),s("li",[s("p",[s("a",{attrs:{href:"https://play.google.com/store/apps/details?id=stericson.busybox",target:"_blank",rel:"noopener noreferrer"}},[e._v("BusyBox"),s("OutboundLink")],1),e._v(" installed on your Android device\nThe "),s("a",{attrs:{href:"http://developer.android.com/sdk/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Android SDK"),s("OutboundLink")],1),e._v(" to get "),s("a",{attrs:{href:"http://developer.android.com/tools/help/adb.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("adb"),s("OutboundLink")],1),e._v(". Just download the (big) SDK, (unpack it)[http://developer.android.com/sdk/installing/bundle.html] and run adb from within.")])]),e._v(" "),s("li",[s("p",[e._v("The programs "),s("a",{attrs:{href:"http://www.cgsecurity.org/wiki/TestDisk",target:"_blank",rel:"noopener noreferrer"}},[e._v("TestDisk"),s("OutboundLink")],1),e._v(", "),s("a",{attrs:{href:"https://code.google.com/p/pipeviewer/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Pipe Viwer"),s("OutboundLink")],1),e._v(" (pv) and optionally "),s("a",{attrs:{href:"http://extundelete.sourceforge.net/",target:"_blank",rel:"noopener noreferrer"}},[e._v("extundelete"),s("OutboundLink")],1),e._v(" (if we are to recover files from ext3/4 filesystems)")])])]),e._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[e._v("apt-get")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("install")]),e._v(" testdisk "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("pv")]),e._v(" extundelete\n")])])]),s("h3",{attrs:{id:"instructions"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#instructions"}},[e._v("#")]),e._v(" Instructions")]),e._v(" "),s("ol",[s("li",[s("p",[s("a",{attrs:{href:"http://developer.android.com/tools/device.html#setting-up",target:"_blank",rel:"noopener noreferrer"}},[e._v("Activate USB Debug on your device"),s("OutboundLink")],1),e._v(" (in order to connect with adb)")])]),e._v(" "),s("li",[s("p",[e._v("Attach your device to the computer via the USB cable")])]),e._v(" "),s("li",[s("p",[e._v("Open a terminal on your computer, go to the Android SDK directory's subdirectory sdk/platform-tools (where adb is located)")])]),e._v(" "),s("li",[s("p",[e._v("Log in to your phone with adb shell:")]),e._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[e._v("./adb shell\n")])])]),s("p",[e._v("(NB: You might have to implicitly call adb start-server as root first if the command above fails.)")])])]),e._v(" "),s("ol",{attrs:{start:"5"}},[s("li",[s("p",[e._v("Now we can either use the mount command to find out what partition holds the SD Card data and dump that one, or we just dump out the entire memory content and skip the thinking part. I find the latter preferable, since the thinking part involved in the first approach is always prone to fail. So then you want to search for a block device called something like")]),e._v(" "),s("p",[s("strong",[e._v("VERY IMPORTANT")]),e._v(" Unlike roubert recovery method which is useful for internal memory, here i also identify it for sd card.")]),e._v(" "),s("p",[e._v("by convetion "),s("strong",[e._v("internal memory")]),e._v(" is")]),e._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[e._v("/dev/block/mmcblk0\n")])])]),s("p",[s("strong",[e._v("sd card")]),e._v(" is")]),e._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[e._v("/dev/block/mmcblk1\n")])])]),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[e._v("shell@android:/ "),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# ls /dev/block")]),e._v("\ndm-0\ndm-1\ndm-2\nloop0\nloop1\nloop2\nloop3\nloop4\nloop5\nloop6\nloop7\nmmcblk0\nmmcblk0boot0\nmmcblk0boot1\nmmcblk0p1\nmmcblk0p10\nmmcblk0p11\nmmcblk0p12\nmmcblk0p13\nmmcblk0p14\nmmcblk0p2\nmmcblk0p3\nmmcblk0p4\nmmcblk0p5\nmmcblk0p6\nmmcblk0p7\nmmcblk0p8\nmmcblk0p9\nram0\nram1\nram10\nram11\nram12\nram13\nram14\nram15\nram2\nram3\nram4\nram5\nram6\nram7\nram8\nram9\nvold\nzram0\nshell@android:/ "),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("#")]),e._v("\n")])])])])]),e._v(" "),s("p",[e._v("Here we see that there are several partitions within mmcblk0, but we leave it for TestDisk to take care of the partitions later.")]),e._v(" "),s("ol",{attrs:{start:"6"}},[s("li",[s("p",[e._v("Exit the shell to go back to the Android SDK directory's subdirectory sdk/platform-tools on your computer.")])]),e._v(" "),s("li",[s("p",[e._v("Now let us dump the content of that /dev/block/mmcblk0 that we found to the computer. With adb shell we can become superuser and execute cat to dump the content like this:")])])]),e._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[e._v(" $ ./adb shell "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("su")]),e._v(" -c "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"cat /dev/block/mmcblk0"')]),e._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("|")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("pv")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v(" mmcblk0.raw\n")])])]),s("p",[e._v("Pipe Viwer (pv) is optional, but I like to see the transfer progress information it provides.\n(And of course you can change mmcblk0.raw to some other directory/filename if you want to.)")]),e._v(" "),s("p",[e._v("Addition: Andr√© Paix√£o wrote to me that he just got an empty file with the command above. He solved it by using "),s("a",{attrs:{href:"http://forum.xda-developers.com/showthread.php?t=1687590",target:"_blank",rel:"noopener noreferrer"}},[e._v("adbd insecure"),s("OutboundLink")],1),e._v(".")]),e._v(" "),s("p",[e._v("Addition: Daniel Jeli≈Ñski wrote to me that he ran into "),s("a",{attrs:{href:"http://stackoverflow.com/questions/13578416/read-binary-stdout-data-from-adb-shell",target:"_blank",rel:"noopener noreferrer"}},[e._v("issues with LF encoding"),s("OutboundLink")],1),e._v(". The solution that worked for him was:")]),e._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[e._v("./adb shell "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("su")]),e._v(" -c "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"cat /dev/block/mmcblk0"')]),e._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("|")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("pv")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("|")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("sed")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'s/^M$//'")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v(" mmcblk0.raw\n")])])]),s("p",[e._v("...where ^M is what you get by pressing Ctrl+V followed by Ctrl+M.")]),e._v(" "),s("p",[e._v("Addition: Marc also ran into the LF problems, but solved it this way:")]),e._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[e._v("./adb shell "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("\"su -c 'stty raw; cat /dev/block/mmcblk0'\"")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("|")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("pv")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v(" mmcblk0.raw\n")])])]),s("p",[e._v("Addition: Tim de Waal wrote to me that he prefers using netcat/gzip instead:")]),e._v(" "),s("p",[e._v("On the Android device (adb shell with su), run:")]),e._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[e._v("dd")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("if")]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("/dev/block/mmcblk0 "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("|")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("gzip")]),e._v(" -9 "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("|")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("nc")]),e._v(" -l "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("5555")]),e._v("\n")])])]),s("p",[e._v("On the computer, run:")]),e._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[e._v("nc")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("AndroidIP"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("5555")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("|")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("pv")]),e._v(" -b "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v(" mmcblk0.img.gz\n")])])]),s("ol",{attrs:{start:"8"}},[s("li",[s("p",[e._v("Now wait until the transfer is done. For a 8 GB device it does not take too long, but still there is time to check some e-mails and browse the web while it finishes.")])]),e._v(" "),s("li",[s("p",[e._v("With the dump on the Linux machine's file system, now we can let TestDisk take it from there:")])])]),e._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[e._v("$ testdisk mmcblk0.raw\n")])])]),s("ol",{attrs:{start:"10"}},[s("li",[e._v("First restore the GPT partition table. Select mmcblk0.raw in the TestDisk interface and choose Proceed:")])]),e._v(" "),s("p",[e._v("Choose EFI GPT partition map:")]),e._v(" "),s("p",[s("img",{attrs:{src:a(246),alt:"image 1"}})]),e._v(" "),s("p",[e._v("Then select Analyse in order for TestDisk to find the partitions:")]),e._v(" "),s("p",[s("img",{attrs:{src:a(247),alt:"image 2"}})]),e._v(" "),s("p",[e._v("Choose Quick Search:")]),e._v(" "),s("p",[s("img",{attrs:{src:a(248),alt:"image 3"}})]),e._v(" "),s("p",[e._v("Hopefully the search will return a nice table like this:")]),e._v(" "),s("p",[s("img",{attrs:{src:a(249),alt:"image 4"}})]),e._v(" "),s("p",[e._v("Then just press enter to continue.")]),e._v(" "),s("p",[s("img",{attrs:{src:a(250),alt:"image 5"}})]),e._v(" "),s("p",[e._v("Select Write to write this new(ly recovered) partition table. Then confirm with Y:")]),e._v(" "),s("p",[s("img",{attrs:{src:a(251),alt:"image 6"}})]),e._v(" "),s("p",[e._v("You will then be informed that you need to reboot. But in our case there is no need for that. Just press enter to continue:")]),e._v(" "),s("p",[s("img",{attrs:{src:a(252),alt:"image 7"}})]),e._v(" "),s("p",[e._v("Now the partition table is restored, and we can go on and try to recover the files.")]),e._v(" "),s("p",[s("img",{attrs:{src:a(253),alt:"image 8"}})]),e._v(" "),s("p",[e._v("Select Advanced to use TestDisk's Filesystem Utils section:")]),e._v(" "),s("p",[s("img",{attrs:{src:a(254),alt:"image 9"}})]),e._v(" "),s("p",[e._v("Select the partition where you want to do the recovery. In this example, we want to recover photos from the FAT32 SD Card partition with the Undelete option:")]),e._v(" "),s("p",[s("img",{attrs:{src:a(255),alt:"image 10"}})]),e._v(" "),s("p",[e._v("Now we can browse the filesystem for files that can be recovered:")]),e._v(" "),s("p",[s("img",{attrs:{src:a(256),alt:"image 11"}})]),e._v(" "),s("p",[e._v("In the /DCIM/100ANDRO directory, where my Android device stores its camera images, we find a lot of files that can be recovered. Select all or some of them, and use either C or c to recover them to one of the Linux computer's file systems (e.g. your home directory):")]),e._v(" "),s("p",[s("img",{attrs:{src:a(257),alt:"image 12"}})]),e._v(" "),s("p",[e._v("Done!")]),e._v(" "),s("p",[e._v("Optional: To recover files from an ext3/ext4 partition, TestDisk has an option Image Creation that will write an image called image.dd of that partition to a file on the Linux computer's file system:")]),e._v(" "),s("p",[s("img",{attrs:{src:a(258),alt:"image 13"}})]),e._v(" "),s("p",[e._v("Then you can use extundelete in your terminal window to recover files from the image:")]),e._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[e._v("extundelete --restore-all image.dd\n")])])]),s("p",[e._v("Thank you very much Mathias Brodala, Piotr Biesiada, Andr√© Paix√£o, Marc, Daniel Jeli≈Ñski and Tim de Waal for sharing your valuable update suggestions and corrections.")])])}),[],!1,null,null,null);t.default=r.exports}}]);